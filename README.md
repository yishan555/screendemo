# 📸 Windows 11 全局备忘录工具

**当前版本**: v2.0.0

一个基于 Electron 的 Windows 11 本地常驻托盘工具，支持全局快捷键触发自动全屏截图、保存截图与剪贴板内容，并提供浮窗操作界面和强大的记录管理功能。

## ✨ 核心功能

### 📸 截图功能
- **托盘常驻**：应用在系统托盘常驻运行
- **全局快捷键**：默认 `Ctrl+Shift+X` 触发截图并可在配置中修改
- **全屏截图**：自动捕获当前操作界面内容并保存
- **剪贴板保存**：同时读取并保存当前剪贴板内容（文本/图片）
- **元数据记录**：自动生成包含时间戳、路径、剪贴板内容的 JSON 元数据文件

### 🪟 智能浮窗
- **快速操作**：截图完成后在鼠标附近弹出操作浮窗
- **编辑 Note**：支持添加和编辑文本笔记
- **自动保存**：Note 内容自动保存，无需手动操作
- **剪贴板预览**：显示文本摘要或图片缩略图

### 📝 记录管理（Memo）
- **全部记录查看**：统一界面管理所有截图和笔记
- **状态管理**：支持 Todo/Done 状态切换和筛选
- **拖拽排序**：自由调整笔记顺序
- **新建笔记**：支持创建纯文本 Note（无截图）
- **缩略图预览**：支持快速查看截图和剪贴板图片

### 🎨 视觉设计
- **现代 UI**：渐变背景、磨砂玻璃效果
- **自定义图标**：统一的图标系统（PNG 格式）
- **无边框设计**：macOS 风格的控制按钮
- **流畅动画**：按钮悬停、点击等交互动画

## 🚀 快速开始

### 1. 安装依赖

```bash
npm install
```

### 2. 启动应用

```bash
npm start
```

## 📋 使用说明

### 截图操作

1. 启动应用后，会在系统托盘显示图标
2. 按下快捷键 `Ctrl+Shift+X` 触发截图
3. 截图完成后会在鼠标附近弹出浮窗
4. 在浮窗中可以：
   - 编辑 Note 文本（自动保存）
   - 查看剪贴板内容预览
   - 点击 Save 保存当前内容
   - 点击 Open Memo Window 打开记录管理窗口

### Memo 记录管理

1. 点击浮窗底部的 "Open Memo Window" 或托盘菜单的 "Memo Window"
2. 在 Memo 窗口中可以：
   - 查看所有历史记录
   - 使用 All/Todo/Done 标签筛选记录
   - 点击复选框切换 Todo/Done 状态
   - 拖拽记录调整顺序
   - **双击记录进入编辑模式**（编辑后排序不变）
   - 点击右下角 "+" 按钮新建纯文本笔记
   - 点击删除按钮删除记录
   - 点击缩略图查看完整图片

### 托盘菜单

右键点击托盘图标可以：
- Screenshot (Ctrl+Shift+X) - 执行截图操作
- Memo Window - 打开记录管理窗口
- Exit - 退出应用

## 📁 文件保存位置

所有截图和元数据文件保存在：

```
C:\Users\<用户名>\AppData\Roaming\screenshot-tray-tool\captures\
```

### 文件命名规则

- **截图文件**：`capture_<日期时间>_<时间戳>.png`
- **元数据文件**：`capture_<日期时间>_<时间戳>.json`

### 元数据格式

```json
{
  "id": 1738483200000,
  "createdAt": "2026-02-02T10:00:00.000Z",
  "imagePath": "C:\\Users\\...\\capture_2026-02-02T10-00-00-000Z_1738483200000.png",
  "clipboardText": "剪贴板文本内容"
}
```

## ⚙️ 配置说明

配置文件位于 [src/main/config.js](src/main/config.js)，可修改以下参数：

- **GLOBAL_SHORTCUT**：全局快捷键（默认 `CommandOrControl+Shift+X`）
- **CAPTURES_DIR_NAME**：保存目录名称
- **FLOAT_WINDOW**：浮窗尺寸和样式配置
- **LOG_LEVEL**：日志级别（debug/info/warn/error）

## 📊 日志系统

应用内置完善的日志记录功能，帮助您调试和优化使用：

### 日志文件位置

日志文件保存在项目根目录的 `logs/` 文件夹：

```
d:\screendemo\logs\
├── app-2026-02-02.log
├── app-2026-02-03.log
└── ...
```

### 日志内容

日志文件记录以下信息：
- ✅ 应用启动和退出事件
- ✅ 截图操作（成功/失败、文件路径、剪贴板内容长度）
- ✅ 用户操作追踪（快捷键触发、托盘菜单点击等）
- ✅ 错误和异常信息（含堆栈跟踪）
- ✅ 配置初始化和资源管理
- ✅ 系统事件和状态变化

### 日志格式

```
[2026-02-02T10:30:45.123Z] [INFO] 应用启动
[2026-02-02T10:30:46.456Z] [INFO] 保存目录: C:\Users\...\captures\
[2026-02-02T10:31:00.789Z] [INFO] 操作: {"operation":"截图成功","timestamp":"2026-02-02T10:31:00.789Z","imagePath":"..."}
```

### 日志级别

在 [src/main/config.js](src/main/config.js) 中可以调整日志级别：

```javascript
LOG_LEVEL: 'info' // 可选值: 'debug' | 'info' | 'warn' | 'error'
```

- `debug` - 详细的调试信息（最详细）
- `info` - 常规操作信息（推荐）
- `warn` - 警告信息
- `error` - 仅错误信息（最简洁）

### 变更日志

项目的所有重要变更记录在 [CHANGELOG.md](CHANGELOG.md) 文件中。

## 🏗️ 项目结构

```
screendemo/
├── src/
│   ├── main/                    # 主进程代码
│   │   ├── index.js            # 应用入口
│   │   ├── config.js           # 配置常量
│   │   ├── configManager.js    # 配置管理器
│   │   ├── logger.js           # 增强日志模块（支持文件输出）
│   │   ├── storage.js          # 存储模块（支持记录 CRUD）
│   │   ├── capture.js          # 截图模块
│   │   ├── tray.js             # 托盘模块
│   │   ├── shortcut.js         # 快捷键模块
│   │   └── windows/
│   │       ├── float.js        # 浮窗管理（支持编辑模式）
│   │       ├── memo.js         # Memo 窗口管理
│   │       └── settings.js     # 设置窗口管理
│   ├── renderer/                # 渲染进程代码
│   │   ├── float.html          # 浮窗页面
│   │   ├── memo.html           # Memo 记录管理页面
│   │   └── settings.html       # 设置页面
│   └── assets/                  # 资源文件
│       └── icons/              # 图标资源
│           ├── screendemo.ico  # 托盘图标
│           ├── title-icon.png  # 标题栏图标
│           ├── icons-save.png  # 保存按钮图标
│           ├── icons-delete.png # 删除按钮图标
│           ├── icons-notebook.png # 笔记本图标
│           └── icons-text.png  # 文本图标
├── logs/                        # 日志文件目录（自动生成）
│   └── app-YYYY-MM-DD.log      # 按日期分割的日志文件
├── package.json
├── CHANGELOG.md                 # 项目变更日志
└── README.md
```

## v2.0.0 新功能

### 🎨 全新 Memo 管理系统
- 统一管理所有截图和笔记记录
- 支持状态管理（Todo/Done）和筛选
- 拖拽排序，自由组织内容
- 双击编辑，灵活修改记录
- 点击 "+" 按钮新建纯文本笔记

### ✨ 智能浮窗体验
- 根据剪贴板类型自动调整高度
- 支持编辑模式和新建模式
- Note 自动保存，无需手动操作

### 🖼️ 现代化视觉设计
- 自定义图标系统
- 按钮磨砂玻璃特效
- 流畅的动画交互
- 优化的 UI 布局

详细更新内容请查看 [CHANGELOG.md](CHANGELOG.md)。

## 🛠️ 技术栈

- **Electron** - 跨平台桌面应用框架
- **screenshot-desktop** - 屏幕截图库
- **Node.js** - JavaScript （运行时）

## 🔧 开发说明

### 日志输出

应用运行时会在控制台输出日志，日志级别可在配置文件中调整。

### 错误处理

应用已内置错误处理机制，出现错误不会导致应用崩溃，错误信息会输出到日志。

### 图标系统

所有图标资源位于 `src/assets/icons/` 目录：
- 托盘图标：screendemo.ico（16x16 或 32x32）
- 应用图标：PNG 格式，支持透明背景
- 推荐尺寸：64x64px 或更高

## 🚧 后续扩展更新

- [ ] 支持多屏幕使用和记录
- [ ] OCR 文字识别
- [ ] 更多主题和样式选项
- [ ] 快捷键冲突检测
- [ ] 导出和导入功能
- [ ] AI总结和快速检索
- [ ] 飞书云端同步
- [ ] 全屏overlay 高亮鼠标周边区域

## 📄 许可证

MIT License

---

**提示**：首次运行时，Windows 可能会弹出防火墙提示，请允许应用访问网络（尽管本应用不需要网络功能，但 Electron 可能会请求）。
