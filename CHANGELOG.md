# 变更日志 (Changelog)

本文档记录项目的所有重要变更和版本更新。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

---

## [1.2.0] - 2026-02-02

### 新增 (Added)
- ✨ **浮窗增强功能**
  - 新增标题栏，支持拖拽移动浮窗
  - 右上角添加红色退出按钮和灰色设置按钮（macOS风格小圆点）
  - 优化浮窗UI设计

- ⚙️ **设置窗口**
  - 全新的设置界面，支持可视化配置
  - 可自定义全局截图快捷键
  - 可自定义截图保存路径
  - 支持重置为默认设置
  - 实时预览当前设置

- 🔧 **配置管理系统**
  - 新增 `configManager.js` 模块，统一管理用户配置
  - 配置文件自动保存到 `AppData/config.json`
  - 支持配置持久化和热更新
  - 快捷键修改后立即生效
  - 保存路径修改后立即生效

### 改进 (Changed)
- 🎨 浮窗标题改为英文 "Screenshot Complete"
- 🎨 浮窗按钮文本改为英文
- 🔧 `storage.js` 支持自定义保存路径
- 🔧 `shortcut.js` 支持动态重新注册快捷键
- 🔧 主进程初始化流程优化，集成配置管理

### 技术细节 (Technical)
- 浮窗支持 `-webkit-app-region: drag` 拖拽功能
- 设置窗口采用无边框设计 (`frame: false`)
- 快捷键录制功能支持实时捕获按键组合
- 配置变更后自动重新初始化相关模块

---

## [1.1.1] - 2026-02-02

### 改进 (Changed)
- 🌐 **所有日志输出改为英文**
  - 解决 PowerShell 控制台中文乱码问题
  - 日志文件中的信息全部使用英文
  - 保持代码注释的中文（便于维护）
  - 改善跨平台兼容性

### 修复 (Fixed)
- 🐛 修复 Windows PowerShell 中日志显示乱码的问题

---

## [1.1.0] - 2026-02-02

### 新增 (Added)
- ✨ **增强的日志系统**
  - 支持将日志输出到文件（保存在项目根目录的 `logs/` 文件夹）
  - 日志文件按日期自动分割（格式：`app-YYYY-MM-DD.log`）
  - 记录应用启动和退出事件
  - 详细记录截图操作（成功/失败、路径、剪贴板内容长度）
  - 记录用户操作日志，便于调试和优化
  - 保持控制台输出的同时，持久化日志到文件

- 📝 **变更日志文件**
  - 创建 `CHANGELOG.md` 文件，记录所有项目变更
  - 遵循 Keep a Changelog 规范

### 改进 (Changed)
- 🔧 重构 `logger.js` 模块，从简单的控制台输出升级为类实例
- 🔧 在主进程入口添加日志系统初始化调用
- 🔧 在快捷键处理中添加详细的操作日志记录
- 🔧 在应用退出时正确关闭日志系统

### 技术细节 (Technical)
- Logger 类支持 `init()` 方法来初始化日志文件
- Logger 类支持 `shutdown()` 方法来写入退出日志
- 新增 `logOperation()` 方法记录用户操作
- 新增 `logCapture()` 方法专门记录截图事件
- 日志文件使用 UTF-8 编码，采用追加写入模式

---

## [1.0.0] - 2026-02-02

### 初始版本 (Initial Release)

#### 核心功能
- ⚡ **托盘常驻**：应用在系统托盘常驻运行，无主窗口干扰
- ⌨️ **全局快捷键**：默认 `Ctrl+Shift+X` 触发截图
- 📸 **全屏截图**：自动捕获主屏幕内容并保存为 PNG 格式
- 📋 **剪贴板保存**：同时读取并保存当前剪贴板文本内容
- 📄 **元数据记录**：自动生成包含时间戳、路径、剪贴板内容的 JSON 元数据文件
- 🪟 **浮窗操作**：截图完成后在鼠标附近弹出操作浮窗
  - 查看截图路径和剪贴板内容摘要
  - 快速打开图片
  - 复制剪贴板文本
  - 打开保存目录

#### 技术架构
- 基于 Electron 28.0.0 构建
- 使用 screenshot-desktop 库进行屏幕捕获
- 模块化设计：
  - `index.js` - 主进程入口
  - `config.js` - 配置管理
  - `logger.js` - 日志模块
  - `storage.js` - 存储管理
  - `capture.js` - 截图功能
  - `tray.js` - 托盘管理
  - `shortcut.js` - 快捷键管理
  - `windows/float.js` - 浮窗管理
  - `renderer/float.html` - 浮窗界面

#### 文件保存
- 默认保存位置：`C:\Users\<用户名>\AppData\Roaming\screenshot-tray-tool\captures\`
- 文件命名：`capture_<ISO日期时间>_<时间戳>.<格式>`
- 同时生成 PNG 图片和 JSON 元数据文件

---

## 变更类型说明

- `Added` - 新增功能
- `Changed` - 现有功能的变更
- `Deprecated` - 即将移除的功能
- `Removed` - 已移除的功能
- `Fixed` - 任何错误修复
- `Security` - 安全相关的修复

---

## 维护说明

每次对项目进行重要更新时，请在本文件顶部添加新版本记录，包括：
- 版本号和日期
- 按类型分类的变更内容
- 重要的技术细节说明
- 已知问题和限制（如有）

**更新时间**: 2026-02-02
**维护者**: 项目开发团队
